# -*- Makefile -*-
libclawpatch_generated_headers =

libclawpatch_installed_headers = \
	src/patches/clawpatch/fclaw_clawpatch_enums.h \
	\
	src/patches/clawpatch/fclaw_clawpatch.hpp \
	src/patches/clawpatch/fclaw_clawpatch.h \
	src/patches/clawpatch/fclaw_clawpatch_diagnostics.h \
	src/patches/clawpatch/fclaw_clawpatch_options.h \
	src/patches/clawpatch/fclaw_clawpatch_output_ascii.h \
	src/patches/clawpatch/fclaw_clawpatch_output_vtk.h \
	src/patches/clawpatch/fclaw_clawpatch_pillow.h \
	\
	src/patches/clawpatch/fclaw2d_clawpatch_transform.h \
	src/patches/clawpatch/fclaw2d_clawpatch_fort.h \
	src/patches/clawpatch/fclaw2d_clawpatch46_fort.h \
	src/patches/clawpatch/fclaw2d_clawpatch5_fort.h \
	\
	src/patches/clawpatch/fclaw3d_clawpatch_fort.h \
	src/patches/clawpatch/fclaw3d_clawpatch46_fort.h \
	\
	src/patches/metric/fclaw2d_metric.h \
	src/patches/metric/fclaw2d_metric.hpp \
	src/patches/metric/fclaw2d_metric_default_fort.h \
	src/patches/metric/fclaw3d_metric.h \
	src/patches/metric/fclaw3d_metric.hpp \
	src/patches/metric/fclaw3d_metric_default_fort.h

libclawpatch_compiled_sources = \
	src/patches/clawpatch/fclaw_clawpatch.cpp \
	src/patches/clawpatch/fclaw_clawpatch_diagnostics.c \
	src/patches/clawpatch/fclaw_clawpatch_diagnostics_default.c \
	src/patches/clawpatch/fclaw_clawpatch_options.c \
	src/patches/clawpatch/fclaw_clawpatch_output_ascii.c \
	src/patches/clawpatch/fclaw_clawpatch_output_vtk.c \
	src/patches/clawpatch/fclaw_clawpatch_pillow.c \
	\
	src/patches/clawpatch/fclaw2d_clawpatch_conservation.c \
	src/patches/clawpatch/fclaw2d_clawpatch_transform.c \
	src/patches/clawpatch/fclaw2d_clawpatch_utils.f \
	\
	src/patches/clawpatch/fclaw3dx_clawpatch_utils.f \
	\
	src/patches/clawpatch/fclaw3d_clawpatch_transform.c \
	src/patches/clawpatch/fclaw3d_clawpatch_utils.f90 \
	\
	src/patches/clawpatch/fort_user/fclaw2d_clawpatch_tag_criteria.c \
	src/patches/clawpatch/fort_user/fclaw2d_clawpatch_difference_exceeds_th.f90 \
	src/patches/clawpatch/fort_user/fclaw2d_clawpatch_value_exceeds_th.f90 \
	src/patches/clawpatch/fort_user/fclaw2d_clawpatch_minmax_exceeds_th.f90 \
	src/patches/clawpatch/fort_user/fclaw2d_clawpatch_gradient_exceeds_th.f90 \
	\
	src/patches/clawpatch/fort3_user/fclaw3d_clawpatch_tag_criteria.c \
	src/patches/clawpatch/fort3_user/fclaw3d_clawpatch_difference_exceeds_th.f90 \
	src/patches/clawpatch/fort3_user/fclaw3d_clawpatch_value_exceeds_th.f90 \
	src/patches/clawpatch/fort3_user/fclaw3d_clawpatch_minmax_exceeds_th.f90 \
	src/patches/clawpatch/fort3_user/fclaw3d_clawpatch_gradient_exceeds_th.f90 \
	\
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_tag4refinement.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_tag4coarsening.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_average.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_copy.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_interpolate.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_local_ghost_pack.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_output_ascii.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_timeinterp.f90  \
	src/patches/clawpatch/fort3_4.6/fclaw3d_clawpatch46_diagnostics.f90 \
	\
	src/patches/clawpatch/fort3_4.6/fclaw3dx_clawpatch46_average.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3dx_clawpatch46_copy.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3dx_clawpatch46_interpolate.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3dx_clawpatch46_local_ghost_pack.f90 \
	src/patches/clawpatch/fort3_4.6/fclaw3dx_clawpatch46_pillowsphere.f90 \
	\
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_tag4refinement.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_tag4coarsening.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_average.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_copy.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_interpolate.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_local_ghost_pack.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_pillowsphere.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_output_ascii.f \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_timeinterp.f  \
	src/patches/clawpatch/fort_4.6/fclaw2d_clawpatch46_diagnostics.f \
	\
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_tag4refinement.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_tag4coarsening.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_average.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_copy.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_interpolate.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_local_ghost_pack.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_pillowsphere.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_output_ascii.f \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_timeinterp.f  \
	src/patches/clawpatch/fort_5.0/fclaw2d_clawpatch5_diagnostics.f \
	\
	src/patches/metric/fclaw2d_metric.cpp \
	src/patches/metric/fclaw2d_metric_default.c \
	src/patches/metric/fclaw3d_metric.cpp \
	src/patches/metric/fclaw3d_metric_default.c \
	src/patches/metric/fortran_source2d/fclaw2d_metric_default_fort.f90 \
	src/patches/metric/fortran_source3d/fclaw3d_metric_default_fort.f90


## Name of library to build
lib_LTLIBRARIES += src/patches/clawpatch/libclawpatch.la

## Named variables that can be referenced from other libraries/apps
FCLAW_CLAWPATCH_CPPFLAGS = -I@top_srcdir@/src/patches/clawpatch \
                           -I@top_srcdir@/src/patches/metric

## Needed for fclaw2d_metric_terms.i
FCLAW_CLAWPATCH_FFLAGS = -I@top_srcdir@/src/patches/metric/fortran_source2d
FCLAW_CLAWPATCH_LDADD    = @top_builddir@/src/patches/clawpatch/libclawpatch.la

## Sources needed to build this library
src_patches_clawpatch_libclawpatch_la_SOURCES = \
        $(libclawpatch_internal_headers) \
        $(libclawpatch_compiled_sources)

## Headers needed to build this library.  
src_patches_clawpatch_libclawpatch_la_CPPFLAGS = \
                $(AM_CPPFLAGS)

## Add headers from this library to general header "pool", to be used by other apps
AM_CPPFLAGS += $(FCLAW_CLAWPATCH_CPPFLAGS)
LDADD       += $(FCLAW_CLAWPATCH_LDADD)
AM_FFLAGS   += $(FCLAW_CLAWPATCH_FFLAGS)


include_HEADERS += $(libclawpatch_installed_headers)

## UNIT TESTS
check_PROGRAMS += src/patches/clawpatch/clawpatch.TEST
TESTS += src/patches/clawpatch/clawpatch.TEST

src_patches_clawpatch_clawpatch_TEST_SOURCES = \
    src/patches/clawpatch/fclaw_clawpatch.h.2d.TEST.cpp \
	src/patches/clawpatch/fclaw_clawpatch.h.3dx.TEST.cpp \
	src/patches/clawpatch/fclaw_clawpatch.h.3d.TEST.cpp \
	src/patches/clawpatch/fclaw_clawpatch.h.3d.ghostfill.TEST.cpp \
	src/patches/clawpatch/fclaw_clawpatch.h.2d.ghostfill.TEST.cpp \
    src/patches/clawpatch/fclaw_clawpatch_options.h.TEST.cpp \
    src/patches/clawpatch/fclaw_clawpatch_diagnostics.h.TEST.cpp \
    src/patches/clawpatch/fclaw2d_clawpatch_fort.h.TEST.cpp \
	src/patches/metric/fclaw2d_metric.h.TEST.cpp

src_patches_clawpatch_clawpatch_TEST_CPPFLAGS = \
	$(test_libtestutils_la_CPPFLAGS) \
    $(src_patches_clawpatch_libclawpatch_la_CPPFLAGS)

src_patches_clawpatch_clawpatch_TEST_LDADD = \
	test/libtestutils.la \
	$(test_libtestutils_la_LDADD) \
    $(LDADD) \
    $(FCLAW_CLAWPATCH_LDADD) \
    $(FCLAW_LDADD)